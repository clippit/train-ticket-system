# 概述

本程序实现了服务器/客户端结构的铁路售票系统模拟。有两种交互模式：

* 基于本地 FIFO(命名管道)
* 基于网络 Socket

两种模式可以通过启动参数进行切换（详见下文）。

## 服务端

服务端采用守护进程模式工作。为简化实现，没有外部配置文件，没有管理脚本。在命令行中可以直接启动服务器，关闭则可使用`killall`命令。

服务器启动后会监听用户请求，一旦接收到便会开启一个新的子进程处理，并将结果返回给相应客户端。

服务器日志使用`syslog`发送，系统需要有`syslogd`或`syslog-ng`等日志管理守护进程运行。在大多数发行版中，它是预配置好的，服务端的日志一般可以在`/var/log/messages.log`中看到。

服务端使用了 [SQLite 3](http://www.sqlite.org/) 数据库，系统中需存在libsqlite3库。一般可以使用发行版相应的软件包管理器进行安装，例如在 [Arch Linux](http://www.archlinux.org/) 下可以使用以下命令：

    sudo pacman -S sqlite

服务端在处理数据库查询时使用了参数绑定，可以防止数据库注入攻击。

## 客户端

客户端采用纯命令行实现。当没有在启动参数中指定用户名和密码时，程序会提示用户输入（如果是注册操作，会提示输入两遍密码以防止输错）。此外所有操作均在命令行参数中完成，没有额外的交互界面。

程序实现了用户注册，登录后查询班次、购买车票、查看已购车票、退票的功能。详细使用方法见下文。


# 编译安装

* 克隆版本库

        $ git clone git://github.com/clippit/train-ticket-system.git
        $ cd train-ticket-system

* 编译

        $ make

* 导入数据库

        $ sqlite3 data.sqlite < dummy.sql